<section id="wall" ng-controller="LibraryCtrl" class="{{ 'filter' + zoomLevel }}">
  <% photos.map(function(photo){ %>
      <img draggable="false" src="<%=photo.src%>" id="<%=photo.id%>" class="v<%=photo.vote%>" height="200" width="<%= Math.floor( (200 * photo.ratio || 0) || 200) %>" />
  <% }) %>
  <div class="slider">
      <label class="pull-right  muted">All your photos</label>
      <label class="pull-left  muted">Only the best</label>
      <label class="pull-center muted">{{nrPhotos}} photos</label>
      <input type="range" ng-model="zoomLevel" id="zoomLevel" max="10" step="1">
    </div>

</section>


<style> 
  section{
    width:120%;
  }

  #wall img{
    float:inherit;
    margin: 0 -1px;
    padding:0px;
    height: 200px;
    border: 0;
    -webkit-transition    :all .3s ease-out-back; 
    -moz-transition       :all .3s ease-out-back;
    transition            :all .3s ease-out-back;

  }


  /* use css instead of javascript to use maximum power from the engine */

  #wall img:hover, #wall img:selection
  {
    min-width: 50px;
    opacity:1;
  }

  .filter0 .v1, .filter0 .v2, .filter0 .v3, .filter0 .v4, .filter0 .v5, .filter0 .v6, .filter0 .v7, .filter0 .v8, .filter0 .v9
  {  background: #444; width:0px; display:none; /*special mode*/}

  .filter1 .v0,.filter1 .v1  
  {  height:600px; width: auto; /*width:inherit*/; }
  .filter1 .v2, .filter1 .v3, .filter1 .v4, .filter1 .v5, .filter1 .v6, .filter1 .v7, .filter1 .v8, .filter1 .v9
  {  background: #444; width:2px;  opacity:0.4;}

  .filter2 .v0, .filter2 .v1, .filter2 .v2 
  {  /*width:inherit*/; }
  .filter2 .v3, .filter2 .v4, .filter2 .v5, .filter2 .v6, .filter2 .v7, .filter2 .v8, .filter2 .v9
  {  background: #444; width:2px;  opacity:0.4;}
 
  .filter4 .v0, .filter3 .v1, .filter3 .v2, .filter3 .v3 
  {  /*width:inherit*/; }
  .filter3 .v4, .filter3 .v5, .filter3 .v6, .filter3 .v7, .filter3 .v8, .filter3 .v9
  {  background: #444; width:3px;  opacity:0.4;}

  .filter4 .v0, .filter4 .v1, .filter4 .v2, .filter4 .v3, .filter4 .v4 
  {  /*width:inherit*/; }
  .filter4 .v5, .filter4 .v6, .filter4 .v7, .filter4 .v8, .filter4 .v9
  {  background: #444; width:3px; opacity:0.4;}

  .filter5 .v0, .filter5 .v1, .filter5 .v2, .filter5 .v3, .filter5 .v4, .filter5 .v5 
  {  /*width:inherit*/; }
  .filter5 .v6, .filter5 .v7, .filter5 .v8, .filter5 .v9
  {  background: #444; width:5px; opacity:0.4;}

  .filter6 .v0, .filter6 .v1, .filter6 .v2, .filter6 .v3, .filter6 .v4, .filter6 .v5, .filter6 .v6 
  {  /*width:inherit*/; }
  .filter6 .v7, .filter6 .v8, .filter6 .v9
  {  background: #444; width:10px; opacity:0.4;}

  .filter7 .v0, .filter7 .v1, .filter7 .v2, .filter7 .v3, .filter7 .v4, .filter7 .v5, .filter7 .v6, .filter7 .v7 
  {  /*width:inherit*/; }
   .filter7 .v8, .filter7 .v9
  {  background: #444; width:10px; opacity:0.4;}

  .filter8 .v0, .filter8 .v1, .filter8 .v2, .filter8 .v3, .filter8 .v4, .filter8 .v5, .filter8 .v6, .filter8 .v7, .filter8 .v8 
  {  /*width:inherit*/; }
    .filter8 .v9
  {  background: #444; width:20px; opacity:0.4;}

  .filter9 .v0, .filter9 .v1, .filter9 .v2, .filter9 .v3, .filter9 .v4, .filter9 .v5, .filter9 .v6, .filter9 .v7, .filter9 .v8, .filter9 .v9 
  {  /*width:inherit*/; }


</style>

<script>

  function LibraryCtrl($scope)
  {
    $scope.zoomLevel = 5;
    $scope.$watch('zoomLevel', function(value){
      target = target || document.getElementById(document.location.hash.replace('#','')); 
      clearTimeout(scrollTimeout);
      scrollTimeout = setInterval(function(){target.scrollIntoView()}, 200);
    });
  }


  var scrollTimeout;
  var target;

  document.querySelector( '#wall' ).addEventListener( 'click', function( event ) {
    if (event.target.tagName == "IMG") {
      var target = event.target;
      target.src = target.src.replace('thumbnails', 'originals');
      location.href = "#" + target.id;
      target.className = 'v' + Math.max(0, parseInt(target.className) - 1);
    }
  } );

</script>